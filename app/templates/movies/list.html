{% extends "base.html" %}

{% set is_series = is_series|default(false) %}
{% set title = "–°–µ—Ä–∏–∞–ª—ã" if is_series else "–§–∏–ª—å–º—ã" %}
{% set new_url = url_for('main.series_create') if is_series else url_for('main.movie_create') %}
{% set item_type = "—Å–µ—Ä–∏–∞–ª" if is_series else "—Ñ–∏–ª—å–º" %}

{% block title %}{{ title }}{% endblock %}
{% block content %}
<h2>{{ title }}</h2>

{% if current_user.is_authenticated %}
<a href="{{ new_url }}" class="btn btn-success mb-3">‚ûï –î–æ–±–∞–≤–∏—Ç—å {{ item_type }}</a>
{% endif %}

<div class="row">
    {% for item in items %}
    <div class="col-md-6 mb-3">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">{{ item.title }}</h5>
                <p class="card-text">
                    {% if is_series %}
                    –°–µ–∑–æ–Ω–æ–≤: {{ item.seasons or '‚Äî' }}<br>
                    {% else %}
                    –ì–æ–¥: {{ item.year or '‚Äî' }}<br>
                    {% endif %}
                    –ñ–∞–Ω—Ä: {{ item.genre or '‚Äî' }}<br>
                    {{ item.description or '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç' }}
                </p>
                {% if current_user.is_authenticated %}
                <a href="{{ url_for('main.series_edit' if is_series else 'main.movie_edit', id=item.id) }}"
                   class="btn btn-sm btn-outline-primary">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                <form method="POST" style="display:inline"
                      action="{{ url_for('main.series_delete' if is_series else 'main.movie_delete', id=item.id) }}"
                      onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å {{ item_type }}?')">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <button type="submit" class="btn btn-sm btn-outline-danger">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                </form>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}